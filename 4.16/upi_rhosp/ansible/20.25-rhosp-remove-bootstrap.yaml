---
- name: "Collect information"
  import_playbook: _common_rhosp.yaml
  when: ocp_cluster_id_tag is not defined

- name: "Cleanup network infrastructure"
  hosts: "localhost"
  gather_facts: true

  tasks:
  - name: "Delete Bootstrap from members of the public load-balancer pools"
    include_tasks: tasks/rhosp-loadbalancer-member.yaml
    vars:
      rhosp_lb_member_state: absent
      rhosp_lb_member_address: "{{ rhosp_public_lb_pool_members_item.addr }}"
      rhosp_lb_member_name: "{{ rhosp_public_lb_pool_members_item.name }}"
      rhosp_lb_member_pool: "{{ rhosp_loadbalancer_pool_name }}-public"
      rhosp_lb_member_ports: "{{ rhosp_lb_public_ports }}"
    loop: "{{ rhosp_instance_bootstrap_array }}"
    loop_control:
      loop_var: rhosp_public_lb_pool_members_item

  - name: "Delete Bootstrap from members of the private load-balancer pools"
    include_tasks: tasks/rhosp-loadbalancer-member.yaml
    vars:
      state: absent
      rhosp_lb_member_address: "{{ rhosp_private_lb_pool_members_item.addr }}"
      rhosp_lb_member_name: "{{ rhosp_private_lb_pool_members_item.name }}"
      rhosp_lb_member_pool: "{{ rhosp_loadbalancer_pool_name }}-internal"
      rhosp_lb_member_ports: "{{ rhosp_lb_internal_ports }}"
    loop: "{{ rhosp_instance_bootstrap_array }}"
    loop_control:
      loop_var: rhosp_private_lb_pool_members_item

...
